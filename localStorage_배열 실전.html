<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>로컬스토리지 array 저장, 불러오기 예제</title>
</head>
<body>

  <!--
    로컬스토리지에 배열(array) 형태로 데이터 저장 및 불러오기 예제
    - JSON.stringify() : 자바스크립트 객체/배열 -> JSON 문자열 변환
    - JSON.parse()   : JSON 문자열 -> 자바스크립트 객체/배열 변환

    사용자가 입력한 값을 배열로 저장하고, 배열로 불러오는 간단한 예제

    ex) 최근검색어 저장, 체크리스트 추가삭제, 태그입력기능, 메모목록저장, 장바구니목록저장 등


    **기본개념**
      + start. 코파일럿 정리분
        **기본개념**
          - localStorage: 브라우저에 key-value 쌍으로 데이터 저장 (영구저장)
          - 값은 문자열로만 저장 가능
          - 객체/배열 형태로 저장하려면 JSON.stringify() 사용
          - 불러올 때는 JSON.parse() 사용하여 원래 형태로 복원
        **저장과 불러오기 흐름**
          - localStorage.getItem('키이름') 으로 저장된 문자열 가져오기
          - JSON.parse() 로 문자열 -> 배열 변환
          - 저장된 값이 없으면 빈 배열([]) 반환
          - 배열에 새 항목 추가
          - JSON.stringify() 로 배열 -> 문자열 변환 
          - localStorage.setItem('키이름', 문자열) 으로 다시 저장
        **화면 업데이트**
          - 저장된 배열을 불러와서 화면에 리스트로 출력
        **주의사항**
            - localStorage에는 문자열만 저장 가능
            - 객체/배열 형태로 저장하려면 JSON.stringify() 사용
            - 불러올 때는 JSON.parse() 사용하여 원래 형태로 복원
            - JSON.parse() 사용 시 저장된 데이터가 없거나 형식이 올바르지 않으면 오류 발생 가능
            - 예제에서는 간단히 처리했으나, 실제 사용 시 오류처리 필요
        **활용예시**        
          - 최근검색어 기록
          - 체크리스트 추가/삭제
          - 태그 입력 기능
          - 메모 목록 저장
          - 장바구니 목록 저장
        **참고자료**
          - MDN Web Docs: https://developer.mozilla.org/ko/docs/Web/API/Window/localStorage
          - JSON.stringify(): https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify
          - JSON.parse(): https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse
      + end. 코파일럿 정리분

      + start. GPT 정리분
        **기본개념(핵심)**
          - 기존 배열을 lacalStorage 에서 가져온다. (없으면 빈 배열)
          - 새값을 push() 로 배열에 추가한다.
          - 다시 localStorage 에 저장한다. (JSON.stringify() 사용)
          - 필요시 저장된 배열을 불러와서 화면에 리스트로 출력한다.
  -->

  <div class="container">
    <input type="text" id="itemInput" placeholder="값 입력">
    <button id="addBtn">추가</button>

    <ul id="list"></ul>

  </div>


  <!-- 
    **실행흐름**
      - 유저가 input에 값을 입력 후 '추가' 버튼 클릭
      - 기존 배열(loadList) 가져오기
      - 새 값(input 값)을 배열에 추가(push 이용)
      - JSON.stringify() 로 localStorage 에 다시 저장(saveList)
      - 화면에 즉시 반영(렌더링)

    **localStorage 내부 저장결과 예시**
      - key: 'myList'
      - value: '["값1","값2","값3"]'  (문자열 형태로 저장)  => ex) '["apple","banana","cherry"]'
      - 브라우저에서 JSON.parse(localStorage.getItem('myList')) 하면 다시 배열로 복원됨

    **삭제버튼을 붙여서 각 항목별 삭제기능도 추가 가능 (((localStorage splice 삭제 실전 파일에서 재정리)))**
      - 배열에서 splice() 등으로 항목 제거 후 다시 저장 및 렌더링
      - 렌더링은 renderList() 함수 재호출  !

    **개발자도구 console 에서 보는법(value)**
      - localStorage.getItem('myList'); => '["apple","banana","cherry"]' // 문자열
      - JSON.parse(localStorage.getItem('myList')); => ["apple", "banana", "cherry"] // 배열
      - JSON.parse(localStorage.getItem('myList'))[0];  => "apple"  // 배열의 첫번째 항목
      
    **key 값의 이름을 개발자도구로 확인하는 법**
      - 개발자도구 Application 탭 → 좌측 메뉴에서 'Storage' → 'Local Storage' 선택 → 해당 도메인 클릭
      - 우측 창에서 key칼럼, value칼럼 확인 가능
      - key 칼럼에서 'myList' 확인 가능!!(다른 배열도 있을경우 같이 확인가능.)
      - 무조건 확인할 수 있고, 숨겨진 key는 없다. 


    ** 기타 localStorage 주요 메서드 **
      - localStorage.setItem('key', 'value');  // key-value 쌍 저장
      - localStorage.getItem('key');           // key에 해당하는 값 반환
      - localStorage.key(0);  // 0번째 key 이름 반환
      - localStorage.key(1);  // 1번째 key 이름 반환
      - localStorage.length;   // 저장된 key-value 쌍의 개수 반환
  -->
  
  <script>
    const STORAGE_KEY = 'myList';

    // 저장된 배열 불러오기 (없으면 빈 배열)
    function loadList() {
      const stored = localStorage.getItem(STORAGE_KEY);
      return stored ? JSON.parse(stored) : [];
    }

    // 배열 저장
    function saveList(arr) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
    }

    // 화면 업데이트
    function renderList(arr) {
      const listEl = document.getElementById('list');
      listEl.innerHTML = arr.map(item => `<li>${item}</li>`).join('');
    }

    // 추가 버튼 클릭
    document.getElementById('addBtn').addEventListener('click', () => {
      const input = document.getElementById('itemInput');
      const value = input.value.trim();
      if (!value) return;

      const list = loadList();   // 기존 배열 불러오기
      list.push(value);          // 새 항목 추가
      saveList(list);            // 다시 저장

      renderList(list);          // 화면 갱신
      input.value = '';          // 입력창 초기화
    });

    // 페이지 로드 시 바로 불러오기
    window.addEventListener('DOMContentLoaded', () => {
      const saved = loadList();
      renderList(saved);
    });

  </script>
</body>
</html>